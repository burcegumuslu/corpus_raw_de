{"title": "1 Beh.faktor - Lat.Quadrat - Poissondaten", "author": null, "url": null, "hostname": null, "description": null, "sitename": "1 Beh.faktor - Lat.Quadrat", "date": null, "id": null, "license": null, "body": null, "comments": "", "commentsbody": null, "raw_text": null, "text": "library(data.table) # bessere Datenmanipulation library(ggplot2); library(ggfortify) # bessere Plots library(emmeans) # adjustierte Mittelwerte\nIn diesem Beispiel wurden 5 verschiedene Begasungsbehandlungen f\u00fcr Schnellk\u00e4fer (Elateridae) mit 5 Wiederholungen getestet. Das Versuchsdesign war ein lateinisches Quadrat - sowohl die Spalten als auch die Zeilen sind also vollst\u00e4ndige Bl\u00f6cke. In jeder Parzelle wurden im Jahr nach der Behandlung die Schnellk\u00e4ferlarven gez\u00e4hlt.\n## Warning in if (class(data) == \"formula\") {: the condition has length > 1 and only ## the first element will be used\n## Warning in if (class(data) == \"formula\") {: the condition has length > 1 and only ## the first element will be used\nprint(bugs, nrows=10)\n## trt row col bugs ## 1: P 1 1 3 ## 2: M 2 1 6 ## 3: O 3 1 4 ## 4: N 4 1 17 ## 5: K 5 1 4 ## --- ## 21: M 1 5 4 ## 22: P 2 5 4 ## 23: N 3 5 5 ## 24: K 4 5 0 ## 25: O 5 5 8\nstr(bugs)\n## Classes 'data.table' and 'data.frame': 25 obs. of 4 variables: ## $ trt : Factor w/ 5 levels \"K\",\"M\",\"\".. ## $ row : Factor w/ 5 levels \"1\",\"2\",\"\".. ## $ col : Factor w/ 5 levels \"1\",\"2\",\"\".. ## $ bugs: int 3 6 4 17 4 2 0 9 8 4 ... ## - attr(*, \".internal.selfref\")=<exter..\nErst wollen wir ein Gef\u00fchl f\u00fcr den Datensatz bekommen und betrachten einen Boxplot f\u00fcr die Anzahl gefundener Larven pro Behandlung. Die F\u00fcllfarben die Boxen sind dieselben Farben wie im Feldplan und wurden zuvor von uns im Vektor\ntrtfarben gespeichert -\n[mehr Infos dazu hier](datr_desplot.html).\nboxplot(bugs ~ trt, col=trtfarben, data=bugs, las=2) # las=2 dreht die Achsenbeschriftung\nWie zu erkennen, ist das Auftreten der Larven ein relativ seltenes Ereignis, sodass die meisten Werte nahe 0 liegen. Wir haben also Z\u00e4hlwerte ohne feste Beschr\u00e4nkung nach oben und k\u00f6nnen uns entscheiden eine Poissonverteilung f\u00fcr diese Daten anzunehmen und ein entsprechendes generalisiertes lineares Modell anpassen (\n[mehr dazu hier](appendix_nichtnormalverteilt.html)). Bez\u00fcglich der Effekte im Modell verfahren wir \u00e4hnlich einer [einfaktoriellen ANOVA in einem RCBD](1f_rcbd.html), allerdings mit noch einem zweiten vollst\u00e4ndigen Block Effekt, sodass wir Effekte f\u00fcr Zeilen und Spalten haben.\nmod <- glm(bugs ~ trt + row + col, family=quasipoisson(link=\"log\"), data=bugs)\nWie im\n[vorangegangenen Beispiel](1f_rcbd_binomial.html), legen wir die erwartete Verteileung mit dem\nfamily= statement fest. Ebenso entscheiden wir uns direkt f\u00fcr\nquasipoisson anstelle der einfacheren\npoisson Verteilung, da diese in gewisser Hinischt flexibler/robuster ist (\n[mehr dazu hier](intro_glm_carrot.html)). Auch hier ist der Zusatz\n(link=\"log\") eigentlich \u00fcberfl\u00fcssig, weil dies die standardm\u00e4\u00dfige Linkfunktion f\u00fcr poissonverteilte Daten ist. Sie wird hier aber zur Verdeutlichung mit ins Modell geschrieben.\nautoplot(mod)[1:2] # Residuenplots\n## Warning: `arrange_()` is deprecated as of dplyr 0.7.0. ## Please use `arrange()` instead. ## See vignette('programming') for more help ## This warning is displayed once every 8 hours. ## Call `lifecycle::last_warnings()` to see where this warning was generated.\nanova(mod, test=\"Chisq\")\n## Analysis of Deviance Table ## ## Model: quasipoisson, link: log ## ## Response: bugs ## ## Terms added sequentially (first to last) ## ## ## Df Deviance Resid. Df Resid. Dev Pr(>Chi) ## NULL 24 64.555 ## trt 4 26.5294 20 38.026 0.001428 ** ## row 4 15.6955 16 22.331 0.033385 * ## col 4 2.8225 12 19.508 0.757711 ## --- ## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\ncar::Anova(mod, test.statistic=\"Wald\")\n## Registered S3 methods overwritten by 'car': ## method from ## influence.merMod lme4 ## cooks.distance.influence.merMod lme4 ## dfbeta.influence.merMod lme4 ## dfbetas.influence.merMod lme4\n## Analysis of Deviance Table (Type II tests) ## ## Response: bugs ## Df Chisq Pr(>Chisq) ## trt 4 10.8143 0.02873 * ## row 4 9.6828 0.04612 * ## col 4 1.9627 0.74262 ## --- ## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nDer p-Wert f\u00fcr den Behandlungseffekt weist in diesem Fall auf unterschiedliche H\u00e4ufigkeiten der gefundenen Larven hin.\nMittels des\nemmeans() package lassen wir uns\n[wie im vorigen Beispiel](1f_rcbd_binomial.html) direkt die r\u00fccktransformierten Mittelwerte sch\u00e4tzen. Dazu muss lediglich\ntype=\"response\" hinzugef\u00fcgt werden.\nmeans <- emmeans(mod, pairwise ~ trt, type=\"response\") # Mittelwertvergleiche means <- CLD(means$emmeans, Letters = letters) # Buchstabenddarstellung means$.group <- gsub(\" \", \"\", means$.group, fixed = TRUE) # Entferne Leerzeichen means\n## trt rate SE df asymp.LCL asymp.UCL .group ## K 1.116262 0.5634313 Inf 0.415072 3.001986 a ## P 4.435874 1.1504576 Inf 2.668194 7.374642 ab ## O 5.419780 1.2711275 Inf 3.422513 8.582585 b ## M 5.934068 1.3345778 Inf 3.818708 9.221224 b ## N 6.184781 1.3733085 Inf 4.002377 9.557198 b ## ## Results are averaged over the levels of: row, col ## Confidence level used: 0.95 ## Intervals are back-transformed from the log scale ## P value adjustment: tukey method for comparing a family of 5 estimates ## Tests are performed on the log scale ## significance level used: alpha = 0.05\nggplot() + theme_classic() + # Rohdaten (bugs) geom_boxplot(data=bugs, aes(x=trt, y=bugs), outlier.shape=NA, width=0.6, fill=trtfarben) + geom_jitter(data=bugs, aes(x=trt, y=bugs), width=0.1, shape=1, size=2) + # Ergebnisse (means) geom_point(data=means, aes(x=as.numeric(trt)+0.4, y=rate), col=\"red\", shape=16, size=2) + geom_errorbar(data=means, aes(x=as.numeric(trt)+0.4, ymin=asymp.LCL, ymax=asymp.UCL), col=\"red\", width=0.1) + geom_text(data=means, aes(x=trt, y=11, label =.group), col=\"red\") + labs(y=\"Schwarz: Beobachtete Anzahl Larven\\nRot: R\u00fccktransformierter, adjustierter Mittelwert f\u00fcr die \\nH\u00e4ufigkeit \u00b1 95% asympt. Konfidenzintervall\", x=\"Behandlung\", caption=\"Mittelwerte, die mit einem gemeinsamen Buchstaben versehen sind,\\n sind laut Tukey-test auf der Log-Skala nicht signifikant voneinander verschieden.\")\nBei Fragen kannst du mir gerne schreiben!\nschmidtpaul@hotmail.de", "language": null, "image": null, "pagetype": null, "links": ["index.html", "index.html", "#", "datr_importexport.html", "datr_descriptivestats.html", "datr_desplot.html", "datr_multipledat.html", "datr_moreadvanced.html", "#", "1n_drinks.html", "outlier_vision.html", "1f_crd.html", "1f_rcbd.html", "1f_alpha.html", "2f_rcbd.html", "2f_splitplot.html", "1f_augmented_blockfixorrandom.html", "1f_rcbd_messwdh.html", "1f_rcbd_binomial.html", "1f_latsq_poisson.html", "#", "stat_korrelation.html", "stat_regression.html", "appendix_designs.html", "appendix_posthoc.html", "appendix_interaktionen.html", "stat_adjmeans.html", "stat_pvalue.html", "stat_gemischtemodelle.html", "appendix_kovarstrukt.html", "3f_met_regions.html", "intro_glm_carrot.html", "stat_logisticregression.html", "appendix_modelrules.html", "stat_samplesize.html", "kontaktseite.html", "datr_desplot.html", "appendix_nichtnormalverteilt.html", "1f_rcbd.html", "1f_rcbd_binomial.html", "intro_glm_carrot.html", "1f_rcbd_binomial.html", "https://www.researchgate.net/profile/Paul_Schmidt17/research", "https://www.linkedin.com/in/schmidtpaul1989/", "https://www.xing.com/profile/Paul_Schmidt203/cv/", "https://github.com/SchmidtPaul/", "https://hits.seeyoufarm.com"]}